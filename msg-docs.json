{"openapi":"3.0.0","paths":{"/api/subscribe":{"post":{"operationId":"NotificationController_subscribe","summary":"subscribe to topic","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TopicManageBodyDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TopicManageResponseDto"}}}}},"tags":["notification"]}},"/api/unsubscribe":{"post":{"operationId":"NotificationController_unsubscribe","summary":"unsubscribe from topic","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TopicManageBodyDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TopicManageResponseDto"}}}}},"tags":["notification"]}},"/api/send":{"post":{"operationId":"NotificationController_sendMessage","summary":"send message","parameters":[{"name":"dry_run","required":false,"in":"query","schema":{"type":"boolean"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageSendBodyDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageSendResponseDto"}}}}},"tags":["notification"]}},"/api/send-each":{"post":{"operationId":"NotificationController_sendEachMessage","summary":"multicast message sending","parameters":[{"name":"dry_run","required":false,"in":"query","schema":{"type":"boolean"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MulticastSendBodyDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MulticastSendResponseDto"}}}}},"tags":["notification"]}}},"info":{"title":"Notifications","description":"","version":"0.1","contact":{}},"tags":[],"servers":[],"components":{"schemas":{"TopicManageBodyDto":{"type":"object","properties":{"tokens":{"type":"array","items":{"type":"string"}},"topic":{"type":"string"}},"required":["tokens","topic"]},"FirebaseErrorDto":{"type":"object","properties":{"code":{"type":"string"},"message":{"type":"string"},"stack":{"type":"string"}},"required":["code","message"]},"FirebaseArrayIndexError":{"type":"object","properties":{"index":{"type":"number"},"error":{"$ref":"#/components/schemas/FirebaseErrorDto"}},"required":["index","error"]},"FirebaseTopicManageResponseDto":{"type":"object","properties":{"duration":{"type":"number","description":"request duration in milliseconds"},"failureCount":{"type":"number"},"successCount":{"type":"number"},"errors":{"type":"array","items":{"$ref":"#/components/schemas/FirebaseArrayIndexError"}}},"required":["duration","failureCount","successCount","errors"]},"HuaweiArrayIndexError":{"type":"object","properties":{"index":{"type":"number"},"reason":{"type":"string"}},"required":["index","reason"]},"HuaweiTopicManageResponseDto":{"type":"object","properties":{"duration":{"type":"number","description":"request duration in milliseconds"},"failureCount":{"type":"number"},"successCount":{"type":"number"},"code":{"type":"string"},"msg":{"type":"string"},"requestId":{"type":"string"},"errors":{"type":"array","items":{"$ref":"#/components/schemas/HuaweiArrayIndexError"}}},"required":["duration","failureCount","successCount","code","msg","requestId","errors"]},"TopicManageResponseDto":{"type":"object","properties":{"firebase":{"$ref":"#/components/schemas/FirebaseTopicManageResponseDto"},"huawei":{"$ref":"#/components/schemas/HuaweiTopicManageResponseDto"}},"required":["firebase","huawei"]},"BaseNotificationDto":{"type":"object","properties":{"title":{"type":"string"},"body":{"type":"string"},"imageUrl":{"type":"string"}}},"LightSettings":{"type":"object","properties":{"color":{"type":"string","description":"Required. Sets color of the LED in `#rrggbb` or `#rrggbbaa` format."},"lightOnDurationMillis":{"type":"number","description":"Required. Along with `light_off_duration`, defines the blink rate of LED flashes."},"lightOffDurationMillis":{"type":"number","description":"Required. Along with `light_on_duration`, defines the blink rate of LED flashes."}},"required":["color","lightOnDurationMillis","lightOffDurationMillis"]},"AndroidNotificationDto":{"type":"object","properties":{"title":{"type":"string","description":"Title of the Android notification. When provided, overrides the title set via `admin.messaging.Notification`."},"body":{"type":"string","description":"Body of the Android notification. When provided, overrides the body set via `admin.messaging.Notification`."},"icon":{"type":"string","description":"Icon resource for the Android notification."},"color":{"type":"string","description":"Notification icon color in `#rrggbb` format."},"sound":{"type":"string","description":"File name of the sound to be played when the device receives the notification."},"tag":{"type":"string","description":"Notification tag. This is an identifier used to replace existing notifications in the notification drawer. If not specified, each request creates a new notification."},"imageUrl":{"type":"string","description":"URL of an image to be displayed in the notification."},"clickAction":{"type":"string","description":"Action associated with a user click on the notification. If specified, an activity with a matching Intent Filter is launched when a user clicks on thenotification."},"bodyLocKey":{"type":"string","description":"Key of the body string in the app's string resource to use to localize the body text."},"bodyLocArgs":{"description":"An array of resource keys that will be used in place of the format specifiers in `bodyLocKey`.","type":"array","items":{"type":"string"}},"titleLocKey":{"type":"string","description":"Key of the title string in the app's string resource to use to localize the title text."},"titleLocArgs":{"description":"An array of resource keys that will be used in place of the format specifiers in `titleLocKey`.","type":"array","items":{"type":"string"}},"channelId":{"type":"string","description":"The Android notification channel ID (new in Android O). The app must create a channel with this channel ID before any notification with this channel ID can be received. If you don't send this channel ID in the request, or if the channel ID provided has not yet been created by the app, FCM uses the channel ID specified in the app manifest."},"ticker":{"type":"string","description":"Sets the \"ticker\" text, which is sent to accessibility services. Prior to API level 21 (Lollipop), sets the text that is displayed in the status bar when the notification first arrives."},"sticky":{"type":"boolean","description":"When set to `false` or unset, the notification is automatically dismissed when the user clicks it in the panel. When set to `true`, the notification persists even when the user clicks it."},"eventTimestamp":{"format":"date-time","type":"string","description":"For notifications that inform users about events with an absolute time reference, sets the time that the event in the notification occurred. Notifications in the panel are sorted by this time."},"localOnly":{"type":"boolean","description":"Sets whether or not this notification is relevant only to the current device. Some notifications can be bridged to other devices for remote display, such as a Wear OS watch. This hint can be set to recommend this notification not be bridged. See {@link https://developer.android.com/training/wearables/notifications/bridger#existing-method-of-preventing-bridging | Wear OS guides}."},"priority":{"type":"string","enum":["min","low","default","high","max"],"description":"Sets the relative priority for this notification. Low-priority notifications may be hidden from the user in certain situations. Note this priority differs from `AndroidMessagePriority`. This priority is processed by the client after the message has been delivered. Whereas `AndroidMessagePriority` is an FCM concept that controls when the message is delivered."},"vibrateTimingsMillis":{"description":"Sets the vibration pattern to use. Pass in an array of milliseconds to turn the vibrator on or off. The first value indicates the duration to wait before turning the vibrator on. The next value indicates the duration to keep the vibrator on. Subsequent values alternate between duration to turn the vibrator off and to turn the vibrator on. If `vibrate_timings` is set and `default_vibrate_timings` is set to `true`, the default value is used instead of the user-specified `vibrate_timings`.","type":"array","items":{"type":"number"}},"defaultVibrateTimings":{"type":"boolean","description":"If set to `true`, use the Android framework's default vibrate pattern for the notification. Default values are specified in {@link https://android.googlesource.com/platform/frameworks/base/+/master/core/res/res/values/config.xml | config.xml}. If `default_vibrate_timings` is set to `true` and `vibrate_timings` is also set, the default value is used instead of the user-specified `vibrate_timings`."},"defaultSound":{"type":"boolean","description":"If set to `true`, use the Android framework's default sound for the notification. Default values are specified in {@link https://android.googlesource.com/platform/frameworks/base/+/master/core/res/res/values/config.xml | config.xml}."},"lightSettings":{"description":"Settings to control the notification's LED blinking rate and color if LED is available on the device. The total blinking time is controlled by the OS.","allOf":[{"$ref":"#/components/schemas/LightSettings"}]},"defaultLightSettings":{"type":"boolean","description":"If set to `true`, use the Android framework's default LED light settings for the notification. Default values are specified in {@link https://android.googlesource.com/platform/frameworks/base/+/master/core/res/res/values/config.xml | config.xml}. If `default_light_settings` is set to `true` and `light_settings` is also set, the user-specified `light_settings` is used instead of the default value."},"visibility":{"type":"string","enum":["private","public","secret"],"description":"Sets the visibility of the notification. Must be either `private`, `public`, or `secret`. If unspecified, defaults to `private`."},"notificationCount":{"type":"number","description":"Sets the number of items this notification represents. May be displayed as a badge count for Launchers that support badging. See {@link https://developer.android.com/training/notify-user/badges | NotificationBadge}. For example, this might be useful if you're using just one notification to represent multiple new messages but you want the count here to represent the number of total new messages. If zero or unspecified, systems that support badging use the default, which is to increment a number displayed on the long-press menu each time a new notification arrives."}}},"AndroidFcmOptions":{"type":"object","properties":{"analyticsLabel":{"type":"string","description":"The label associated with the message's analytics data."}}},"AndroidConfig":{"type":"object","properties":{"collapseKey":{"type":"string","description":"Collapse key for the message. Collapse key serves as an identifier for a group of messages that can be collapsed, so that only the last message gets sent when delivery can be resumed. A maximum of four different collapse keys may be active at any given time."},"priority":{"type":"string","enum":["high","normal"],"description":"Priority of the message. Must be either `normal` or `high`."},"ttl":{"type":"number","description":"Time-to-live duration of the message in milliseconds."},"restrictedPackageName":{"type":"string","description":"Package name of the application where the registration tokens must match in order to receive the message."},"data":{"type":"object","description":"A collection of data fields to be included in the message. All values must be strings. When provided, overrides any data fields set on the top-level"},"notification":{"description":"Android notification to be included in the message.","allOf":[{"$ref":"#/components/schemas/AndroidNotificationDto"}]},"fcmOptions":{"description":"Options for features provided by the FCM SDK for Android.","allOf":[{"$ref":"#/components/schemas/AndroidFcmOptions"}]}}},"WebpushAction":{"type":"object","properties":{"action":{"type":"string","description":"An action available to the user when the notification is presented"},"icon":{"type":"string","description":"Optional icon for a notification action."},"title":{"type":"string","description":"Title of the notification action."}},"required":["action","title"]},"WebpushNotification":{"type":"object","properties":{"title":{"type":"string","description":"Title text of the notification."},"actions":{"description":"An array of notification actions representing the actions available to the user when the notification is presented.","type":"array","items":{"$ref":"#/components/schemas/WebpushAction"}},"badge":{"type":"string","description":"URL of the image used to represent the notification when there is not enough space to display the notification itself."},"body":{"type":"string","description":"Body text of the notification."},"data":{"oneOf":[{"type":"object"},{"type":"string"},{"type":"number"}],"description":"Arbitrary data that you want associated with the notification. This can be of any data type."},"dir":{"type":"string","enum":["auto","ltf","rtl"],"description":"The direction in which to display the notification. Must be one of `auto`, `ltr` or `rtl`."},"icon":{"type":"string","description":"URL to the notification icon."},"image":{"type":"string","description":"URL of an image to be displayed in the notification."},"lang":{"type":"string","description":"The notification's language as a BCP 47 language tag."},"renotify":{"type":"boolean","description":"A boolean specifying whether the user should be notified after a new notification replaces an old one. Defaults to false."},"requireInteraction":{"type":"boolean","description":"Indicates that a notification should remain active until the user clicks or dismisses it, rather than closing automatically. Defaults to false."},"silent":{"type":"boolean","description":"A boolean specifying whether the notification should be silent. Defaults to false."},"tag":{"type":"string","description":"An identifying tag for the notification."},"timestamp":{"type":"number","description":"Timestamp of the notification. Refer to https://developer.mozilla.org/en-US/docs/Web/API/notification/timestamp for details."},"vibrate":{"type":"object","description":"A vibration pattern for the device's vibration hardware to emit when the notification fires."}}},"WebpushFcmOptions":{"type":"object","properties":{"link":{"type":"string","description":"The link to open when the user clicks on the notification. For all URL values, HTTPS is required."}}},"WebpushConfig":{"type":"object","properties":{"headers":{"type":"object","description":"A collection of WebPush headers. Header values must be strings. See {@link https://tools.ietf.org/html/rfc8030#section-5 | WebPush specification} for supported headers."},"data":{"type":"object","description":"A collection of data fields."},"notification":{"description":"A WebPush notification payload to be included in the message.","allOf":[{"$ref":"#/components/schemas/WebpushNotification"}]},"fcmOptions":{"description":"Options for features provided by the FCM SDK for Web.","allOf":[{"$ref":"#/components/schemas/WebpushFcmOptions"}]}}},"ApsAlert":{"type":"object","properties":{"title":{"type":"string"},"subtitle":{"type":"string"},"body":{"type":"string"},"locKey":{"type":"string"},"locArgs":{"type":"array","items":{"type":"string"}},"titleLocKey":{"type":"string"},"titleLocArgs":{"type":"array","items":{"type":"string"}},"subtitleLocKey":{"type":"string"},"subtitleLocArgs":{"type":"array","items":{"type":"string"}},"actionLocKey":{"type":"string"},"launchImage":{"type":"string"}}},"CriticalSound":{"type":"object","properties":{"critical":{"type":"boolean","description":"The critical alert flag. Set to `true` to enable the critical alert."},"name":{"type":"string","description":"The name of a sound file in the app's main bundle or in the `Library/Sounds` folder of the app's container directory. Specify the string \"default\" to play the system sound."},"volume":{"type":"number","description":"The volume for the critical alert's sound. Must be a value between 0.0 (silent) and 1.0 (full volume)."}},"required":["name"]},"Aps":{"type":"object","properties":{"alert":{"anyOf":[{"type":"string"},{"$ref":"#/components/schemas/ApsAlert"}],"description":"Alert to be included in the message. This may be a string or an object of type `admin.messaging.ApsAlert`."},"badge":{"type":"number","description":"Badge to be displayed with the message. Set to 0 to remove the badge. Whennot specified, the badge will remain unchanged."},"sound":{"description":"Sound to be played with the message.","oneOf":[{"type":"string"},{"$ref":"#/components/schemas/CriticalSound"}]},"contentAvailable":{"type":"boolean","description":"Specifies whether to configure a background update notification."},"mutableContent":{"type":"boolean","description":"Specifies whether to set the `mutable-content` property on the message so the clients can modify the notification via app extensions."},"category":{"type":"string","description":"Type of the notification."},"threadId":{"type":"string","description":"An app-specific identifier for grouping notifications."}}},"ApnsPayload":{"type":"object","properties":{"aps":{"description":"The `aps` dictionary to be included in the message.","allOf":[{"$ref":"#/components/schemas/Aps"}]}},"required":["aps"]},"ApnsFcmOptions":{"type":"object","properties":{"analyticsLabel":{"type":"string","description":"The label associated with the message's analytics data."},"imageUrl":{"type":"string","description":"URL of an image to be displayed in the notification."}}},"ApnsConfig":{"type":"object","properties":{"headers":{"type":"object","description":"A collection of APNs headers. Header values must be strings."},"payload":{"description":"An APNs payload to be included in the message.","allOf":[{"$ref":"#/components/schemas/ApnsPayload"}]},"fcmOptions":{"description":"Options for features provided by the FCM SDK for iOS.","allOf":[{"$ref":"#/components/schemas/ApnsFcmOptions"}]}}},"FcmOptions":{"type":"object","properties":{"analyticsLabel":{"type":"string","description":"The label associated with the message's analytics data."}}},"NotificationMessageDto":{"type":"object","properties":{"data":{"type":"object"},"notification":{"$ref":"#/components/schemas/BaseNotificationDto"},"android":{"description":"Represents the Android-specific options","allOf":[{"$ref":"#/components/schemas/AndroidConfig"}]},"webpush":{"description":"Represents the WebPush protocol options","allOf":[{"$ref":"#/components/schemas/WebpushConfig"}]},"apns":{"description":"Represents the APNs-specific options ","allOf":[{"$ref":"#/components/schemas/ApnsConfig"}]},"fcmOptions":{"$ref":"#/components/schemas/FcmOptions"},"topic":{"type":"string"},"condition":{"type":"string"},"token":{"type":"string"}}},"MessageSendBodyDto":{"type":"object","properties":{"message":{"$ref":"#/components/schemas/NotificationMessageDto"}},"required":["message"]},"FirebaseMessageResponseDto":{"type":"object","properties":{"duration":{"type":"number","description":"request duration in milliseconds"},"messageId":{"type":"string"}},"required":["duration","messageId"]},"HuaweiMessageResponseDto":{"type":"object","properties":{"duration":{"type":"number","description":"request duration in milliseconds"},"code":{"type":"string"},"msg":{"type":"string"},"requestId":{"type":"string"}},"required":["duration","code","msg","requestId"]},"MessageSendResponseDto":{"type":"object","properties":{"firebase":{"$ref":"#/components/schemas/FirebaseMessageResponseDto"},"huawei":{"$ref":"#/components/schemas/HuaweiMessageResponseDto"}},"required":["firebase","huawei"]},"MessageDto":{"type":"object","properties":{"data":{"type":"object"},"notification":{"$ref":"#/components/schemas/BaseNotificationDto"},"android":{"description":"Represents the Android-specific options","allOf":[{"$ref":"#/components/schemas/AndroidConfig"}]},"webpush":{"description":"Represents the WebPush protocol options","allOf":[{"$ref":"#/components/schemas/WebpushConfig"}]},"apns":{"description":"Represents the APNs-specific options ","allOf":[{"$ref":"#/components/schemas/ApnsConfig"}]},"fcmOptions":{"$ref":"#/components/schemas/FcmOptions"}}},"MulticastSendBodyDto":{"type":"object","properties":{"tokens":{"type":"array","items":{"type":"string"}},"message":{"$ref":"#/components/schemas/MessageDto"}},"required":["tokens","message"]},"SendResponse":{"type":"object","properties":{"success":{"type":"boolean","description":"A boolean indicating if the message was successfully handed off to FCM or not. When true, the `messageId` attribute is guaranteed to be set. When false, the `error` attribute is guaranteed to be set."},"messageId":{"type":"string","description":"A unique message ID string, if the message was handed off to FCM for delivery."},"error":{"description":"An error, if the message was not handed off to FCM successfully.","allOf":[{"$ref":"#/components/schemas/FirebaseErrorDto"}]}},"required":["success"]},"FirebaseBatchResponse":{"type":"object","properties":{"duration":{"type":"number","description":"request duration in milliseconds"},"responses":{"description":"An array of responses, each corresponding to a message.","type":"array","items":{"$ref":"#/components/schemas/SendResponse"}},"successCount":{"type":"number","description":"The number of messages that were successfully handed off for sending."},"failureCount":{"type":"number","description":"The number of messages that resulted in errors when sending."}},"required":["duration","responses","successCount","failureCount"]},"MulticastSendResponseDto":{"type":"object","properties":{"firebase":{"$ref":"#/components/schemas/FirebaseBatchResponse"},"huawei":{"$ref":"#/components/schemas/HuaweiMessageResponseDto"}},"required":["firebase","huawei"]}}}}